@page "/forgotpw"
@using RealEstate.App.Auth
@using RealEstate.App.Models
@using RealEstate.App.Validators
@inject HttpClient Http
@inject IJSRuntime JSRuntime
@inject NavigationManager navigationManager
@inject CustomStateProvider authStateProvider

<head>
    <link rel="stylesheet" href="css/styles.css" />
</head>

<div class="content-container">
    <div class="auth-message"><p>@error</p></div>
    <div class="form-card">
        <div class="auth-form-buttons-div">
            <NavLink href="login">
                <button class="auth-form-button">
                    Back to sign in
                </button>
            </NavLink>

        </div>
        <EditForm Model="@forgotPwRequest" OnValidSubmit="OnSubmit">
            <hr class="auth-hr">

            <div class="auth-input-div">
                <label class="auth-recovery-label" for="email">Please enter your email to start the password recovery process</label>
                <br>

                <InputText id="email" type="email" class="auth-input" placeholder="Enter email" @bind-Value="forgotPwRequest.email"  required />
            </div>

            <input class="auth-form-submit-button" type="submit" value="Submit">
            <hr class="auth-hr">
        </EditForm>
    </div>
</div>

@code {
    private ForgotPasswordViewModel forgotPwRequest = new ForgotPasswordViewModel();
    public string error = "";

    async Task OnSubmit()
    {
        error = null;
        try
        {
            await authStateProvider.ForgotPassword(forgotPwRequest);
        }
        catch (Exception ex)
        {
            error = ex.Message;
        }
    }
}
